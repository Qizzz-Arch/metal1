<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="é‡‘å±ææ–™çº¿è†¨èƒ€è‡ªåŠ¨åŒ–åˆ†æç³»ç»Ÿ - ç”±è®¸éº’æ”¿å¼€å‘çš„ææ–™ç§‘å­¦åˆ†æå·¥å…·">
    <meta name="keywords" content="é‡‘å±ææ–™,çº¿è†¨èƒ€ç³»æ•°,ææ–™ç§‘å­¦,è‡ªåŠ¨åŒ–åˆ†æ,è®¸éº’æ”¿">
    <meta name="author" content="è®¸éº’æ”¿">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="index, follow">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“Š</text></svg>">
    <title>é‡‘å±ææ–™çº¿è†¨èƒ€è‡ªåŠ¨åŒ–åˆ†æç³»ç»Ÿ - è®¸éº’æ”¿</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.js"></script>
    <style>
        @media (max-width: 640px) {
            .table-container {
                overflow-x: auto;
            }
        }
        .calculation-process {
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-8">é‡‘å±ææ–™çº¿è†¨èƒ€è‡ªåŠ¨åŒ–åˆ†æç³»ç»Ÿ</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- å·¦ä¾§é¢æ¿ï¼šæ•°æ®è¾“å…¥å’Œå‚æ•°è®¾ç½® -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                    <h2 class="text-xl font-semibold mb-4">é¢„è®¾å‚æ•°</h2>
                    
                    <!-- ææ–™ç±»å‹é€‰æ‹© -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ææ–™ç±»å‹</label>
                        <select id="materialType" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                            <option value="ç´«é“œ">ç´«é“œ</option>
                            <option value="é“">é“</option>
                            <option value="é“">é“</option>
                            <option value="ä¸é”ˆé’¢">ä¸é”ˆé’¢</option>
                        </select>
                    </div>

                    <!-- è‡ªåŠ¨å¡«å……è®¾ç½® -->
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">èµ·å§‹æ¸©åº¦ (Â°C)</label>
                            <input type="number" id="startTemp" value="20.0" step="0.1" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">æ¸©åº¦æ­¥é•¿ (Â°C)</label>
                            <input type="number" id="tempStep" value="10.0" step="0.1" min="0.1"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        </div>
                    </div>
                    <button id="autoFill" class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 mb-4">
                        è‡ªåŠ¨å¡«å……æ¸©åº¦
                    </button>

                    <!-- æ•°æ®è¡¨æ ¼ -->
                    <div class="table-container">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead>
                                <tr>
                                    <th class="px-4 py-2 bg-gray-50">åºå·</th>
                                    <th class="px-4 py-2 bg-gray-50">å®æµ‹æ¸©åº¦ (Â°C)</th>
                                    <th class="px-4 py-2 bg-gray-50">åƒåˆ†è¡¨è¯»æ•° (mm)</th>
                                </tr>
                            </thead>
                            <tbody id="dataTable">
                                <!-- JavaScript å°†åŠ¨æ€å¡«å……è¿™é‡Œ -->
                            </tbody>
                        </table>
                    </div>

                    <!-- æ“ä½œæŒ‰é’® -->
                    <div class="grid grid-cols-3 gap-4 mt-4">
                        <button id="calculate" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                            è®¡ç®—
                        </button>
                        <button id="showProcess" class="px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700" disabled>
                            è®¡ç®—è¿‡ç¨‹
                        </button>
                        <button id="export" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">
                            å¯¼å‡º
                        </button>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§é¢æ¿ï¼šç»“æœæ˜¾ç¤ºå’Œå›¾è¡¨ -->
            <div class="lg:col-span-2">
                <!-- è®¡ç®—ç»“æœ -->
                <div id="results" class="bg-white rounded-lg shadow-lg p-6 mb-8 hidden">
                    <h2 class="text-xl font-semibold mb-4">è®¡ç®—ç»“æœ</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div class="bg-gray-50 p-4 rounded">
                            <h3 class="font-medium">æœ€å°äºŒä¹˜æ³•</h3>
                            <p id="lsResult" class="text-lg"></p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded">
                            <h3 class="font-medium">é€å·®æ³•</h3>
                            <p id="diffResult" class="text-lg"></p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded">
                            <h3 class="font-medium">ç›¸å…³ç³»æ•° (RÂ²)</h3>
                            <p id="rSquared" class="text-lg"></p>
                        </div>
                    </div>
                    <div id="chart" class="w-full h-96"></div>
                </div>

                <!-- è®¡ç®—è¿‡ç¨‹å¯¹è¯æ¡† -->
                <div id="processDialog" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center">
                    <div class="bg-white rounded-lg shadow-lg p-6 max-w-4xl max-h-[80vh] overflow-y-auto">
                        <h2 class="text-xl font-semibold mb-4">è®¡ç®—è¿‡ç¨‹</h2>
                        <div id="processContent" class="calculation-process bg-gray-50 p-4 rounded"></div>
                        <button class="mt-4 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700" onclick="document.getElementById('processDialog').classList.add('hidden')">
                            å…³é—­
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¸¸é‡å®šä¹‰
        const L0 = 500; // åˆå§‹é•¿åº¦ï¼Œå•ä½ï¼šmm

        // åˆå§‹åŒ–æ•°æ®è¡¨æ ¼
        const dataTable = document.getElementById('dataTable');
        for (let i = 0; i < 8; i++) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="px-4 py-2 text-center">${i + 1}</td>
                <td class="px-4 py-2">
                    <input type="number" step="0.1" class="w-full px-2 py-1 border rounded temperature" 
                           placeholder="æ¸©åº¦">
                </td>
                <td class="px-4 py-2">
                    <input type="number" step="0.001" class="w-full px-2 py-1 border rounded reading" 
                           placeholder="è¯»æ•°">
                </td>
            `;
            dataTable.appendChild(row);
        }

        // è‡ªåŠ¨å¡«å……æ¸©åº¦æ•°æ®
        document.getElementById('autoFill').addEventListener('click', function() {
            const startTemp = parseFloat(document.getElementById('startTemp').value);
            const step = parseFloat(document.getElementById('tempStep').value);
            
            const temperatures = document.getElementsByClassName('temperature');
            for (let i = 0; i < temperatures.length; i++) {
                temperatures[i].value = (startTemp + i * step).toFixed(1);
            }
        });

        // è®¡ç®—å‡½æ•°
        function calculate() {
            // è·å–æ•°æ®
            const temperatures = Array.from(document.getElementsByClassName('temperature'))
                .map(input => parseFloat(input.value));
            const readings = Array.from(document.getElementsByClassName('reading'))
                .map(input => parseFloat(input.value));

            // éªŒè¯æ•°æ®
            if (temperatures.some(isNaN) || readings.some(isNaN)) {
                alert('è¯·å¡«å†™å®Œæ•´çš„å®éªŒæ•°æ®ï¼');
                return null;
            }

            // è®¡ç®—Î”Tå’ŒÎ”L
            const deltaT = temperatures.map(t => t - temperatures[0]);
            const deltaL = readings.map(r => r - readings[0]);

            // æœ€å°äºŒä¹˜æ³•è®¡ç®—
            const n = temperatures.length;
            let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;
            for (let i = 0; i < n; i++) {
                sumX += deltaT[i];
                sumY += deltaL[i];
                sumXY += deltaT[i] * deltaL[i];
                sumX2 += deltaT[i] * deltaT[i];
            }

            const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;

            // è®¡ç®—RÂ²
            const yMean = sumY / n;
            let totalSS = 0, residualSS = 0;
            const fitLine = deltaT.map(t => slope * t + intercept);

            for (let i = 0; i < n; i++) {
                totalSS += Math.pow(deltaL[i] - yMean, 2);
                residualSS += Math.pow(deltaL[i] - fitLine[i], 2);
            }

            const rSquared = 1 - (residualSS / totalSS);

            // é€å·®æ³•è®¡ç®—
            const deltaTDiff = [];
            const deltaLDiff = [];
            for (let i = 1; i < n; i++) {
                deltaTDiff.push(temperatures[i] - temperatures[i-1]);
                deltaLDiff.push(readings[i] - readings[i-1]);
            }

            const diffAlpha = math.mean(deltaLDiff) / (L0 * math.mean(deltaTDiff));

            // è®¡ç®—çº¿è†¨èƒ€ç³»æ•°ï¼ˆæœ€å°äºŒä¹˜æ³•ï¼‰
            const lsAlpha = slope / L0;

            return {
                lsAlpha,
                diffAlpha,
                rSquared,
                temperatures,
                deltaL,
                fitLine,
                slope,
                intercept,
                deltaT
            };
        }

        // æ˜¾ç¤ºè®¡ç®—è¿‡ç¨‹
        function showCalculationProcess(results) {
            const process = `è®¡ç®—è¿‡ç¨‹ï¼š

1. æ•°æ®é¢„å¤„ç†
   åˆå§‹é•¿åº¦ Lâ‚€ = ${L0} mm
   æ¸©åº¦æ•°æ® T = [${results.temperatures.join(', ')}] â„ƒ
   è¯»æ•°æ•°æ® L = [${results.deltaL.map(l => l.toFixed(3)).join(', ')}] mm

2. æœ€å°äºŒä¹˜æ³•è®¡ç®—
   æ–œç‡ k = ${results.slope.toExponential(4)}
   æˆªè· b = ${results.intercept.toExponential(4)}
   çº¿è†¨èƒ€ç³»æ•° Î± = k/Lâ‚€ = ${results.lsAlpha.toExponential(6)} /â„ƒ

3. é€å·®æ³•è®¡ç®—
   çº¿è†¨èƒ€ç³»æ•° Î± = ${results.diffAlpha.toExponential(6)} /â„ƒ

4. æ‹Ÿåˆä¼˜åº¦
   RÂ² = ${results.rSquared.toFixed(6)}`;

            document.getElementById('processContent').textContent = process;
            document.getElementById('processDialog').classList.remove('hidden');
        }

        // è®¡ç®—æŒ‰é’®äº‹ä»¶
        document.getElementById('calculate').addEventListener('click', function() {
            const results = calculate();
            if (!results) return;

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('lsResult').textContent = `Î± = ${(results.lsAlpha * 1e6).toFixed(6)} Ã— 10â»â¶ /â„ƒ`;
            document.getElementById('diffResult').textContent = `Î± = ${(results.diffAlpha * 1e6).toFixed(6)} Ã— 10â»â¶ /â„ƒ`;
            document.getElementById('rSquared').textContent = results.rSquared.toFixed(6);

            // å¯ç”¨è®¡ç®—è¿‡ç¨‹æŒ‰é’®
            document.getElementById('showProcess').disabled = false;

            // ç»˜åˆ¶å›¾è¡¨
            const experimentalData = {
                x: results.deltaT,
                y: results.deltaL,
                mode: 'markers',
                type: 'scatter',
                name: 'å®éªŒæ•°æ®',
                marker: { size: 8 }
            };

            const fittedLine = {
                x: results.deltaT,
                y: results.fitLine,
                mode: 'lines',
                type: 'scatter',
                name: 'æœ€å°äºŒä¹˜æ³•æ‹Ÿåˆ',
                line: { color: 'red' }
            };

            const layout = {
                title: 'Î”L-Î”T å˜åŒ–æ›²çº¿',
                xaxis: { title: 'Î”T (â„ƒ)' },
                yaxis: { title: 'Î”L (mm)' }
            };

            Plotly.newPlot('chart', [experimentalData, fittedLine], layout);
        });

        // æ˜¾ç¤ºè®¡ç®—è¿‡ç¨‹æŒ‰é’®äº‹ä»¶
        document.getElementById('showProcess').addEventListener('click', function() {
            const results = calculate();
            if (results) {
                showCalculationProcess(results);
            }
        });

        // å¯¼å‡ºæŒ‰é’®äº‹ä»¶
        document.getElementById('export').addEventListener('click', function() {
            const results = calculate();
            if (!results) return;

            const materialType = document.getElementById('materialType').value;
            const data = {
                materialType,
                initialLength: L0,
                measurements: results.temperatures.map((temp, i) => ({
                    temperature: temp,
                    reading: document.getElementsByClassName('reading')[i].value,
                    deltaL: results.deltaL[i]
                })),
                results: {
                    lsAlpha: results.lsAlpha,
                    diffAlpha: results.diffAlpha,
                    rSquared: results.rSquared
                }
            };

            // åˆ›å»ºCSVå†…å®¹
            const csvContent = `é‡‘å±ææ–™çº¿è†¨èƒ€ç³»æ•°æµ‹é‡å®éªŒæ•°æ®
ææ–™ç±»å‹ï¼š${materialType}
åˆå§‹é•¿åº¦ï¼š${L0} mm

åºå·,æ¸©åº¦(â„ƒ),åƒåˆ†è¡¨è¯»æ•°(mm),Î”L(mm)
${results.temperatures.map((temp, i) => 
    `${i + 1},${temp},${document.getElementsByClassName('reading')[i].value},${results.deltaL[i].toFixed(3)}`
).join('\n')}

è®¡ç®—ç»“æœï¼š
æœ€å°äºŒä¹˜æ³•ï¼šÎ± = ${(results.lsAlpha * 1e6).toFixed(6)} Ã— 10â»â¶ /â„ƒ
é€å·®æ³•ï¼šÎ± = ${(results.diffAlpha * 1e6).toFixed(6)} Ã— 10â»â¶ /â„ƒ
ç›¸å…³ç³»æ•°ï¼šRÂ² = ${results.rSquared.toFixed(6)}`;

            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `å®éªŒæ•°æ®_${materialType}_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    </script>
</body>
</html> 
